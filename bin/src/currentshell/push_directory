current_directory=$(pwd)

store_directory_stack() {
  if [[ ! -e $HOME/.directory_stack_store ]]; then
    echo -e "Create $HOME/.directory_stack_store"
    touch $HOME/.directory_stack_store
  fi

  dirs -v | sed "s/^ *[0-9]* *//g" > $HOME/.directory_stack_store
}

if [[ $1 =~ ^[0-9]+$ ]]; then
  pushd "+$@" 1>/dev/null || echo
  store_directory_stack
else
  pushd  "$@" 1>/dev/null || echo
  store_directory_stack
fi

# output directory stack when same directory are pushed
# output directory stack at function autorun() in bashrc when different directory are pushed
if [[ $(pwd) = $current_directory ]]; then
  dirs -v
fi
